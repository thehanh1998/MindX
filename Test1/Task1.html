<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>62152272fb854c4d97dca4f677a3214b</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell code" id="ae16ef6b">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#!pip install pycaret[full]</span></span></code></pre></div>
</div>
<div class="cell code" id="d713c4d1">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r&#39;https://raw.githubusercontent.com/thehanh1998/MindX/main/Test1/loans_full_schema.csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:592,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="11f8c960" data-outputId="d3fe4e7c-64c2-41d6-d97d-6b1c5262a824">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="4">

  <div id="df-94a6903b-32a5-4e43-8691-2cb34841e5ad">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>emp_title</th>
      <th>emp_length</th>
      <th>state</th>
      <th>homeownership</th>
      <th>annual_income</th>
      <th>verified_income</th>
      <th>debt_to_income</th>
      <th>annual_income_joint</th>
      <th>verification_income_joint</th>
      <th>debt_to_income_joint</th>
      <th>...</th>
      <th>sub_grade</th>
      <th>issue_month</th>
      <th>loan_status</th>
      <th>initial_listing_status</th>
      <th>disbursement_method</th>
      <th>balance</th>
      <th>paid_total</th>
      <th>paid_principal</th>
      <th>paid_interest</th>
      <th>paid_late_fees</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>global config engineer</td>
      <td>3.0</td>
      <td>NJ</td>
      <td>MORTGAGE</td>
      <td>90000.0</td>
      <td>Verified</td>
      <td>18.01</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>C3</td>
      <td>Mar-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>27015.86</td>
      <td>1999.33</td>
      <td>984.14</td>
      <td>1015.19</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>warehouse office clerk</td>
      <td>10.0</td>
      <td>HI</td>
      <td>RENT</td>
      <td>40000.0</td>
      <td>Not Verified</td>
      <td>5.04</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>C1</td>
      <td>Feb-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>4651.37</td>
      <td>499.12</td>
      <td>348.63</td>
      <td>150.49</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>assembly</td>
      <td>3.0</td>
      <td>WI</td>
      <td>RENT</td>
      <td>40000.0</td>
      <td>Source Verified</td>
      <td>21.15</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>D1</td>
      <td>Feb-2018</td>
      <td>Current</td>
      <td>fractional</td>
      <td>Cash</td>
      <td>1824.63</td>
      <td>281.80</td>
      <td>175.37</td>
      <td>106.43</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>customer service</td>
      <td>1.0</td>
      <td>PA</td>
      <td>RENT</td>
      <td>30000.0</td>
      <td>Not Verified</td>
      <td>10.16</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>A3</td>
      <td>Jan-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>18853.26</td>
      <td>3312.89</td>
      <td>2746.74</td>
      <td>566.15</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>security supervisor</td>
      <td>10.0</td>
      <td>CA</td>
      <td>RENT</td>
      <td>35000.0</td>
      <td>Verified</td>
      <td>57.96</td>
      <td>57000.0</td>
      <td>Verified</td>
      <td>37.66</td>
      <td>...</td>
      <td>C3</td>
      <td>Mar-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>21430.15</td>
      <td>2324.65</td>
      <td>1569.85</td>
      <td>754.80</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>owner</td>
      <td>10.0</td>
      <td>TX</td>
      <td>RENT</td>
      <td>108000.0</td>
      <td>Source Verified</td>
      <td>22.28</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>A4</td>
      <td>Jan-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>21586.34</td>
      <td>2969.80</td>
      <td>2413.66</td>
      <td>556.14</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>director</td>
      <td>8.0</td>
      <td>PA</td>
      <td>MORTGAGE</td>
      <td>121000.0</td>
      <td>Verified</td>
      <td>32.38</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>D3</td>
      <td>Feb-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>9147.44</td>
      <td>1456.31</td>
      <td>852.56</td>
      <td>603.75</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>toolmaker</td>
      <td>10.0</td>
      <td>CT</td>
      <td>MORTGAGE</td>
      <td>67000.0</td>
      <td>Verified</td>
      <td>45.26</td>
      <td>107000.0</td>
      <td>Source Verified</td>
      <td>29.57</td>
      <td>...</td>
      <td>E2</td>
      <td>Feb-2018</td>
      <td>Current</td>
      <td>fractional</td>
      <td>Cash</td>
      <td>27617.65</td>
      <td>4620.80</td>
      <td>2382.35</td>
      <td>2238.45</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>manager</td>
      <td>1.0</td>
      <td>WI</td>
      <td>MORTGAGE</td>
      <td>80000.0</td>
      <td>Source Verified</td>
      <td>11.99</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>A1</td>
      <td>Feb-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>21518.12</td>
      <td>2873.31</td>
      <td>2481.88</td>
      <td>391.43</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>operations analyst</td>
      <td>3.0</td>
      <td>CT</td>
      <td>RENT</td>
      <td>66000.0</td>
      <td>Not Verified</td>
      <td>20.82</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>B4</td>
      <td>Feb-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>11574.83</td>
      <td>1658.56</td>
      <td>1225.17</td>
      <td>433.39</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 55 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-94a6903b-32a5-4e43-8691-2cb34841e5ad')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-94a6903b-32a5-4e43-8691-2cb34841e5ad button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-94a6903b-32a5-4e43-8691-2cb34841e5ad');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="describe-the-dataset-and-any-issues" class="cell markdown" id="12ada388">
<h1>Describe the dataset and any issues</h1>
</section>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="47ebdb3c" data-outputId="a2fcd191-e6c9-449b-c69d-79563ca40c57">
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check rows and columns</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<pre><code>(10000, 55)</code></pre>
</div>
</div>
<div class="cell markdown" id="7a7959c8">
<p>Dataset has 10000 rows and 55 columns</p>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="0f5ba197" data-outputId="3771104f-686b-4c80-c1d3-b3cb2efcb4aa">
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the data format of the columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="6">
<pre><code>emp_title                            object
emp_length                          float64
state                                object
homeownership                        object
annual_income                       float64
verified_income                      object
debt_to_income                      float64
annual_income_joint                 float64
verification_income_joint            object
debt_to_income_joint                float64
delinq_2y                             int64
months_since_last_delinq            float64
earliest_credit_line                  int64
inquiries_last_12m                    int64
total_credit_lines                    int64
open_credit_lines                     int64
total_credit_limit                    int64
total_credit_utilized                 int64
num_collections_last_12m              int64
num_historical_failed_to_pay          int64
months_since_90d_late               float64
current_accounts_delinq               int64
total_collection_amount_ever          int64
current_installment_accounts          int64
accounts_opened_24m                   int64
months_since_last_credit_inquiry    float64
num_satisfactory_accounts             int64
num_accounts_120d_past_due          float64
num_accounts_30d_past_due             int64
num_active_debit_accounts             int64
total_debit_limit                     int64
num_total_cc_accounts                 int64
num_open_cc_accounts                  int64
num_cc_carrying_balance               int64
num_mort_accounts                     int64
account_never_delinq_percent        float64
tax_liens                             int64
public_record_bankrupt                int64
loan_purpose                         object
application_type                     object
loan_amount                           int64
term                                  int64
interest_rate                       float64
installment                         float64
grade                                object
sub_grade                            object
issue_month                          object
loan_status                          object
initial_listing_status               object
disbursement_method                  object
balance                             float64
paid_total                          float64
paid_principal                      float64
paid_interest                       float64
paid_late_fees                      float64
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown" id="dcdcd95f">
<p>Dataset have 3 types: int64, object, float65.</p>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="bdd9060d" data-outputId="de5ec092-48ad-418c-aca5-3a2d3f1b41db">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Null value</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df.isnull().<span class="bu">sum</span>()</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>emp_title                            833
emp_length                           817
state                                  0
homeownership                          0
annual_income                          0
verified_income                        0
debt_to_income                        24
annual_income_joint                 8505
verification_income_joint           8545
debt_to_income_joint                8505
delinq_2y                              0
months_since_last_delinq            5658
earliest_credit_line                   0
inquiries_last_12m                     0
total_credit_lines                     0
open_credit_lines                      0
total_credit_limit                     0
total_credit_utilized                  0
num_collections_last_12m               0
num_historical_failed_to_pay           0
months_since_90d_late               7715
current_accounts_delinq                0
total_collection_amount_ever           0
current_installment_accounts           0
accounts_opened_24m                    0
months_since_last_credit_inquiry    1271
num_satisfactory_accounts              0
num_accounts_120d_past_due           318
num_accounts_30d_past_due              0
num_active_debit_accounts              0
total_debit_limit                      0
num_total_cc_accounts                  0
num_open_cc_accounts                   0
num_cc_carrying_balance                0
num_mort_accounts                      0
account_never_delinq_percent           0
tax_liens                              0
public_record_bankrupt                 0
loan_purpose                           0
application_type                       0
loan_amount                            0
term                                   0
interest_rate                          0
installment                            0
grade                                  0
sub_grade                              0
issue_month                            0
loan_status                            0
initial_listing_status                 0
disbursement_method                    0
balance                                0
paid_total                             0
paid_principal                         0
paid_interest                          0
paid_late_fees                         0
dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="5b72ce7c">
<p>The data set has relatively low null columns, but there are some columns with a fairly large number of nulls, we will remove some columns with null values greater than 2000 to avoid affecting the results during the analysis data such as: annual_income_joint, verification_income_joint, debt_to_income_joint, months_since_last_delinq, months_since_90d_late.</p>
</div>
<div class="cell markdown" id="1a6bc4ea">
<p>Describe data</p>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:458,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="8f6fac87" data-outputId="41db8b7a-37c9-4f0f-a72f-8cc25c515d81">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.describe(include<span class="op">=</span><span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="8">

  <div id="df-eeea7ba0-653e-4302-8447-32df86e60620">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>emp_title</th>
      <th>emp_length</th>
      <th>state</th>
      <th>homeownership</th>
      <th>annual_income</th>
      <th>verified_income</th>
      <th>debt_to_income</th>
      <th>annual_income_joint</th>
      <th>verification_income_joint</th>
      <th>debt_to_income_joint</th>
      <th>delinq_2y</th>
      <th>months_since_last_delinq</th>
      <th>earliest_credit_line</th>
      <th>inquiries_last_12m</th>
      <th>total_credit_lines</th>
      <th>open_credit_lines</th>
      <th>total_credit_limit</th>
      <th>total_credit_utilized</th>
      <th>num_collections_last_12m</th>
      <th>num_historical_failed_to_pay</th>
      <th>months_since_90d_late</th>
      <th>current_accounts_delinq</th>
      <th>total_collection_amount_ever</th>
      <th>current_installment_accounts</th>
      <th>accounts_opened_24m</th>
      <th>months_since_last_credit_inquiry</th>
      <th>num_satisfactory_accounts</th>
      <th>num_accounts_120d_past_due</th>
      <th>num_accounts_30d_past_due</th>
      <th>num_active_debit_accounts</th>
      <th>total_debit_limit</th>
      <th>num_total_cc_accounts</th>
      <th>num_open_cc_accounts</th>
      <th>num_cc_carrying_balance</th>
      <th>num_mort_accounts</th>
      <th>account_never_delinq_percent</th>
      <th>tax_liens</th>
      <th>public_record_bankrupt</th>
      <th>loan_purpose</th>
      <th>application_type</th>
      <th>loan_amount</th>
      <th>term</th>
      <th>interest_rate</th>
      <th>installment</th>
      <th>grade</th>
      <th>sub_grade</th>
      <th>issue_month</th>
      <th>loan_status</th>
      <th>initial_listing_status</th>
      <th>disbursement_method</th>
      <th>balance</th>
      <th>paid_total</th>
      <th>paid_principal</th>
      <th>paid_interest</th>
      <th>paid_late_fees</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>9167</td>
      <td>9183.000000</td>
      <td>10000</td>
      <td>10000</td>
      <td>1.000000e+04</td>
      <td>10000</td>
      <td>9976.000000</td>
      <td>1.495000e+03</td>
      <td>1455</td>
      <td>1495.000000</td>
      <td>10000.00000</td>
      <td>4342.000000</td>
      <td>10000.00000</td>
      <td>10000.00000</td>
      <td>10000.000000</td>
      <td>10000.00000</td>
      <td>1.000000e+04</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>2285.000000</td>
      <td>10000.0000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>8729.000000</td>
      <td>10000.000000</td>
      <td>9682.0</td>
      <td>10000.0000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000</td>
      <td>10000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000</td>
      <td>10000</td>
      <td>10000</td>
      <td>10000</td>
      <td>10000</td>
      <td>10000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
      <td>10000.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>4741</td>
      <td>NaN</td>
      <td>50</td>
      <td>3</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7</td>
      <td>32</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>manager</td>
      <td>NaN</td>
      <td>CA</td>
      <td>MORTGAGE</td>
      <td>NaN</td>
      <td>Source Verified</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Not Verified</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>debt_consolidation</td>
      <td>individual</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>B</td>
      <td>B1</td>
      <td>Mar-2018</td>
      <td>Current</td>
      <td>whole</td>
      <td>Cash</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>218</td>
      <td>NaN</td>
      <td>1330</td>
      <td>4789</td>
      <td>NaN</td>
      <td>4116</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>611</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5144</td>
      <td>8505</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3037</td>
      <td>647</td>
      <td>3617</td>
      <td>9375</td>
      <td>8206</td>
      <td>9284</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>5.930306</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.922215e+04</td>
      <td>NaN</td>
      <td>19.308192</td>
      <td>1.279146e+05</td>
      <td>NaN</td>
      <td>19.979304</td>
      <td>0.21600</td>
      <td>36.760709</td>
      <td>2001.29000</td>
      <td>1.95820</td>
      <td>22.679600</td>
      <td>11.40440</td>
      <td>1.836062e+05</td>
      <td>51049.063100</td>
      <td>0.013800</td>
      <td>0.167100</td>
      <td>46.112473</td>
      <td>0.0001</td>
      <td>184.334000</td>
      <td>2.663600</td>
      <td>4.376100</td>
      <td>7.340703</td>
      <td>11.379600</td>
      <td>0.0</td>
      <td>0.0001</td>
      <td>3.595300</td>
      <td>27357.410300</td>
      <td>13.030000</td>
      <td>8.095000</td>
      <td>5.230500</td>
      <td>1.383100</td>
      <td>94.648990</td>
      <td>0.043300</td>
      <td>0.123800</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16361.922500</td>
      <td>43.272000</td>
      <td>12.427524</td>
      <td>476.205323</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14458.916610</td>
      <td>2494.234773</td>
      <td>1894.448466</td>
      <td>599.666781</td>
      <td>0.119516</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>3.703734</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.473429e+04</td>
      <td>NaN</td>
      <td>15.004851</td>
      <td>7.016838e+04</td>
      <td>NaN</td>
      <td>8.054781</td>
      <td>0.68366</td>
      <td>21.634939</td>
      <td>7.79551</td>
      <td>2.38013</td>
      <td>11.885439</td>
      <td>5.86828</td>
      <td>1.876327e+05</td>
      <td>53636.731172</td>
      <td>0.126535</td>
      <td>0.687768</td>
      <td>21.748021</td>
      <td>0.0100</td>
      <td>2206.389859</td>
      <td>2.935387</td>
      <td>3.158583</td>
      <td>5.981590</td>
      <td>5.859705</td>
      <td>0.0</td>
      <td>0.0100</td>
      <td>2.434689</td>
      <td>26570.164081</td>
      <td>7.874713</td>
      <td>4.906606</td>
      <td>3.327623</td>
      <td>1.717274</td>
      <td>9.155059</td>
      <td>0.593852</td>
      <td>0.337172</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10301.956759</td>
      <td>11.029877</td>
      <td>5.001105</td>
      <td>294.851627</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9964.561865</td>
      <td>3958.230365</td>
      <td>3884.407175</td>
      <td>517.328062</td>
      <td>1.813468</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.920000e+04</td>
      <td>NaN</td>
      <td>0.320000</td>
      <td>0.00000</td>
      <td>1.000000</td>
      <td>1963.00000</td>
      <td>0.00000</td>
      <td>2.000000</td>
      <td>0.00000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>14.300000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1000.000000</td>
      <td>36.000000</td>
      <td>5.310000</td>
      <td>30.750000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>2.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.500000e+04</td>
      <td>NaN</td>
      <td>11.057500</td>
      <td>8.683350e+04</td>
      <td>NaN</td>
      <td>14.160000</td>
      <td>0.00000</td>
      <td>19.000000</td>
      <td>1997.00000</td>
      <td>0.00000</td>
      <td>14.000000</td>
      <td>7.00000</td>
      <td>5.159375e+04</td>
      <td>19185.500000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>29.000000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>2.000000</td>
      <td>2.000000</td>
      <td>7.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>2.000000</td>
      <td>10000.000000</td>
      <td>7.000000</td>
      <td>5.000000</td>
      <td>3.000000</td>
      <td>0.000000</td>
      <td>92.600000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8000.000000</td>
      <td>36.000000</td>
      <td>9.430000</td>
      <td>256.040000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6679.065000</td>
      <td>928.700000</td>
      <td>587.100000</td>
      <td>221.757500</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>6.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.500000e+04</td>
      <td>NaN</td>
      <td>17.570000</td>
      <td>1.130000e+05</td>
      <td>NaN</td>
      <td>19.720000</td>
      <td>0.00000</td>
      <td>34.000000</td>
      <td>2003.00000</td>
      <td>1.00000</td>
      <td>21.000000</td>
      <td>10.00000</td>
      <td>1.146670e+05</td>
      <td>36927.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>47.000000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>2.000000</td>
      <td>4.000000</td>
      <td>6.000000</td>
      <td>10.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>3.000000</td>
      <td>19500.000000</td>
      <td>11.000000</td>
      <td>7.000000</td>
      <td>5.000000</td>
      <td>1.000000</td>
      <td>100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14500.000000</td>
      <td>36.000000</td>
      <td>11.980000</td>
      <td>398.420000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>12379.495000</td>
      <td>1563.300000</td>
      <td>984.990000</td>
      <td>446.140000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>10.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.500000e+04</td>
      <td>NaN</td>
      <td>25.002500</td>
      <td>1.515455e+05</td>
      <td>NaN</td>
      <td>25.500000</td>
      <td>0.00000</td>
      <td>53.000000</td>
      <td>2006.00000</td>
      <td>3.00000</td>
      <td>29.000000</td>
      <td>14.00000</td>
      <td>2.675500e+05</td>
      <td>65421.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>63.000000</td>
      <td>0.0000</td>
      <td>0.000000</td>
      <td>3.000000</td>
      <td>6.000000</td>
      <td>11.000000</td>
      <td>14.000000</td>
      <td>0.0</td>
      <td>0.0000</td>
      <td>5.000000</td>
      <td>36100.000000</td>
      <td>17.000000</td>
      <td>10.000000</td>
      <td>7.000000</td>
      <td>2.000000</td>
      <td>100.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>24000.000000</td>
      <td>60.000000</td>
      <td>15.050000</td>
      <td>644.690000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20690.182500</td>
      <td>2616.005000</td>
      <td>1694.555000</td>
      <td>825.420000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>10.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.300000e+06</td>
      <td>NaN</td>
      <td>469.090000</td>
      <td>1.100000e+06</td>
      <td>NaN</td>
      <td>39.980000</td>
      <td>13.00000</td>
      <td>118.000000</td>
      <td>2015.00000</td>
      <td>29.00000</td>
      <td>87.000000</td>
      <td>51.00000</td>
      <td>3.386034e+06</td>
      <td>942456.000000</td>
      <td>3.000000</td>
      <td>52.000000</td>
      <td>128.000000</td>
      <td>1.0000</td>
      <td>199308.000000</td>
      <td>35.000000</td>
      <td>29.000000</td>
      <td>24.000000</td>
      <td>51.000000</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>32.000000</td>
      <td>386700.000000</td>
      <td>66.000000</td>
      <td>46.000000</td>
      <td>43.000000</td>
      <td>14.000000</td>
      <td>100.000000</td>
      <td>52.000000</td>
      <td>3.000000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40000.000000</td>
      <td>60.000000</td>
      <td>30.940000</td>
      <td>1566.590000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>40000.000000</td>
      <td>41630.443684</td>
      <td>40000.000000</td>
      <td>4216.440000</td>
      <td>52.980000</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-eeea7ba0-653e-4302-8447-32df86e60620')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-eeea7ba0-653e-4302-8447-32df86e60620 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-eeea7ba0-653e-4302-8447-32df86e60620');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<section id="visualizations" class="cell markdown" id="06eecfd8">
<h1>Visualizations</h1>
</section>
<section id="loan-status-count" class="cell markdown" id="412af87a">
<h2>Loan Status Count</h2>
</section>
<div class="cell code" id="fde6eff1">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:334,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="a1c6cf2a" data-outputId="4cf0d1cf-8de9-4604-f628-c957e14a56f1" data-scrolled="false">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(y<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>, data<span class="op">=</span>df)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/a9005bfed24ced2b2077a19a487960b35accb17a.png" /></p>
</div>
</div>
<div class="cell markdown" id="e2e1bfe4">
<p>Current are the highest followed by Fully Paid. Most of the loan accounts are either Current or the payment is still in progress</p>
</div>
<section id="installment-vs-loan-status-vs-count" class="cell markdown" id="e75fa9e5">
<h2>Installment vs Loan Status vs Count</h2>
</section>
<div class="cell code" data-colab="{&quot;height&quot;:623,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="bedbe637" data-outputId="72ee9d00-eff1-4849-b165-f578718642d9" data-scrolled="false">
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sns.histplot(data<span class="op">=</span>df, x<span class="op">=</span><span class="st">&quot;installment&quot;</span>, bins<span class="op">=</span><span class="dv">30</span>, kde<span class="op">=</span><span class="va">True</span>, hue<span class="op">=</span><span class="st">&quot;loan_status&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="11">
<pre><code>&lt;AxesSubplot:xlabel=&#39;installment&#39;, ylabel=&#39;Count&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/a594e1468d4494e4dc39cef460eb552d68522614.png" /></p>
</div>
</div>
<section id="loan-status-vs-other-attributes" class="cell markdown" id="313016c8">
<h2>Loan Status vs Other Attributes</h2>
</section>
<div class="cell code" data-colab="{&quot;height&quot;:660,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="05e596e5" data-outputId="67f04bd8-aa0f-474e-d37e-2ab03e722a2d">
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>paid_charged <span class="op">=</span> df.loc[(df[<span class="st">&quot;loan_status&quot;</span>] <span class="op">==</span> <span class="st">&quot;Fully Paid&quot;</span>) <span class="op">|</span> (df[<span class="st">&quot;loan_status&quot;</span>] <span class="op">==</span> <span class="st">&quot;Charged Off&quot;</span>)]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">20</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;term&#39;</span>, data<span class="op">=</span>paid_charged, hue<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;homeownership&#39;</span>, data<span class="op">=</span>paid_charged, hue<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;initial_listing_status&#39;</span>, data<span class="op">=</span>paid_charged, hue<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">&#39;loan_purpose&#39;</span>, data<span class="op">=</span>paid_charged, hue<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>g.set_xticklabels(g.get_xticklabels(), rotation<span class="op">=</span><span class="dv">90</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/3b4c4c682f0315a0ddeb098d3e18034591d19859.png" /></p>
</div>
</div>
<section id="grade-vs-loan-status" class="cell markdown" id="&quot;45975928&quot;">
<h2>Grade vs Loan Status</h2>
</section>
<div class="cell code" data-colab="{&quot;height&quot;:315,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="eb2319c4" data-outputId="1ec951d1-03cd-469c-a312-d361ae2c078d" data-scrolled="true">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">10</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>grade <span class="op">=</span> <span class="bu">sorted</span>(paid_charged.grade.unique().tolist())</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">&#39;grade&#39;</span>, data<span class="op">=</span>paid_charged, hue<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>, order<span class="op">=</span>grade)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>sub_grade <span class="op">=</span> <span class="bu">sorted</span>(paid_charged.sub_grade.unique().tolist())</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sns.countplot(x<span class="op">=</span><span class="st">&#39;sub_grade&#39;</span>, data<span class="op">=</span>paid_charged, hue<span class="op">=</span><span class="st">&#39;loan_status&#39;</span>, order<span class="op">=</span>sub_grade)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>g.set_xticklabels(g.get_xticklabels(), rotation<span class="op">=</span><span class="dv">90</span>)<span class="op">;</span></span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/617db55e68b6df0e944eebce176499a40db6ff69.png" /></p>
</div>
</div>
<section id="employee-title-vs-loans-accepted" class="cell markdown" id="d5f5df66">
<h2>Employee Title vs Loans Accepted</h2>
</section>
<div class="cell code" data-colab="{&quot;height&quot;:437,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="c2ce4920" data-outputId="a8a10b35-a8a1-4fa3-c166-8040575cd31b">
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">8</span>, <span class="dv">6</span>))</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>plt.barh(paid_charged.emp_title.value_counts()[:<span class="dv">40</span>].index, paid_charged.emp_title.value_counts()[:<span class="dv">40</span>])</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;The most 30 jobs title afforded a loan&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/a27b8f788afa466c688c696a0a5541d4e8a9a338.png" /></p>
</div>
</div>
<section id="create-a-model-to-predict-interest-rate" class="cell markdown" id="0939d2dc">
<h1>Create a model to predict interest rate</h1>
</section>
<div class="cell code" id="7ec69e55">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> preprocessing</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> LabelEncoder</span></code></pre></div>
</div>
<section id="find-correlation-between-variable-interest_rate-with-another-variables" class="cell markdown" id="8de01b66">
<h3>Find Correlation between variable interest_rate with another variables</h3>
</section>
<div class="cell code" id="6d9208cb">
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df.loc[:,[<span class="st">&#39;interest_rate&#39;</span>,<span class="st">&#39;loan_amount&#39;</span>,<span class="st">&#39;term&#39;</span>,<span class="st">&#39;grade&#39;</span>,<span class="st">&#39;sub_grade&#39;</span>,<span class="st">&#39;annual_income&#39;</span>,<span class="st">&#39;homeownership&#39;</span>,<span class="st">&#39;verified_income&#39;</span>,<span class="st">&#39;debt_to_income&#39;</span>]].copy()</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="8dc738df" data-outputId="857f99d8-3e00-4e49-f377-2e35fc23ee65">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<div class="output execute_result" data-execution_count="17">

  <div id="df-87b32683-d4ec-4a4e-bf1b-e212e3297d38">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>interest_rate</th>
      <th>loan_amount</th>
      <th>term</th>
      <th>grade</th>
      <th>sub_grade</th>
      <th>annual_income</th>
      <th>homeownership</th>
      <th>verified_income</th>
      <th>debt_to_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.07</td>
      <td>28000</td>
      <td>60</td>
      <td>C</td>
      <td>C3</td>
      <td>90000.0</td>
      <td>MORTGAGE</td>
      <td>Verified</td>
      <td>18.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.61</td>
      <td>5000</td>
      <td>36</td>
      <td>C</td>
      <td>C1</td>
      <td>40000.0</td>
      <td>RENT</td>
      <td>Not Verified</td>
      <td>5.04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17.09</td>
      <td>2000</td>
      <td>36</td>
      <td>D</td>
      <td>D1</td>
      <td>40000.0</td>
      <td>RENT</td>
      <td>Source Verified</td>
      <td>21.15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.72</td>
      <td>21600</td>
      <td>36</td>
      <td>A</td>
      <td>A3</td>
      <td>30000.0</td>
      <td>RENT</td>
      <td>Not Verified</td>
      <td>10.16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14.07</td>
      <td>23000</td>
      <td>36</td>
      <td>C</td>
      <td>C3</td>
      <td>35000.0</td>
      <td>RENT</td>
      <td>Verified</td>
      <td>57.96</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>7.35</td>
      <td>24000</td>
      <td>36</td>
      <td>A</td>
      <td>A4</td>
      <td>108000.0</td>
      <td>RENT</td>
      <td>Source Verified</td>
      <td>22.28</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>19.03</td>
      <td>10000</td>
      <td>36</td>
      <td>D</td>
      <td>D3</td>
      <td>121000.0</td>
      <td>MORTGAGE</td>
      <td>Verified</td>
      <td>32.38</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>23.88</td>
      <td>30000</td>
      <td>36</td>
      <td>E</td>
      <td>E2</td>
      <td>67000.0</td>
      <td>MORTGAGE</td>
      <td>Verified</td>
      <td>45.26</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>5.32</td>
      <td>24000</td>
      <td>36</td>
      <td>A</td>
      <td>A1</td>
      <td>80000.0</td>
      <td>MORTGAGE</td>
      <td>Source Verified</td>
      <td>11.99</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>10.91</td>
      <td>12800</td>
      <td>36</td>
      <td>B</td>
      <td>B4</td>
      <td>66000.0</td>
      <td>RENT</td>
      <td>Not Verified</td>
      <td>20.82</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-87b32683-d4ec-4a4e-bf1b-e212e3297d38')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-87b32683-d4ec-4a4e-bf1b-e212e3297d38 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-87b32683-d4ec-4a4e-bf1b-e212e3297d38');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" id="97e2a101">
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change null values of debt_to_income field by mean value</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>mean <span class="op">=</span> df2[<span class="st">&#39;debt_to_income&#39;</span>].mean()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df2[<span class="st">&#39;debt_to_income&#39;</span>] <span class="op">=</span> df2[<span class="st">&#39;debt_to_income&#39;</span>].replace(np.nan,mean)</span></code></pre></div>
</div>
<div class="cell code" id="edf5068f">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LabelEncoder for some fileds: grade, sub_grade, homeownership, verified_income</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>list_lable <span class="op">=</span> [<span class="st">&#39;grade&#39;</span>, <span class="st">&#39;sub_grade&#39;</span>, <span class="st">&#39;homeownership&#39;</span>, <span class="st">&#39;verified_income&#39;</span>]</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> list_lable:</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    df2[i] <span class="op">=</span> LabelEncoder().fit_transform(df2[i])</span></code></pre></div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:424,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="496abefe" data-outputId="761458d5-6093-4e5e-c78e-bc4c8222cba3">
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df2</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">

  <div id="df-9393a3d1-d9cb-4f51-92ec-16a83684c4ef">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>interest_rate</th>
      <th>loan_amount</th>
      <th>term</th>
      <th>grade</th>
      <th>sub_grade</th>
      <th>annual_income</th>
      <th>homeownership</th>
      <th>verified_income</th>
      <th>debt_to_income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>14.07</td>
      <td>28000</td>
      <td>60</td>
      <td>2</td>
      <td>12</td>
      <td>90000.0</td>
      <td>0</td>
      <td>2</td>
      <td>18.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12.61</td>
      <td>5000</td>
      <td>36</td>
      <td>2</td>
      <td>10</td>
      <td>40000.0</td>
      <td>2</td>
      <td>0</td>
      <td>5.04</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17.09</td>
      <td>2000</td>
      <td>36</td>
      <td>3</td>
      <td>15</td>
      <td>40000.0</td>
      <td>2</td>
      <td>1</td>
      <td>21.15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.72</td>
      <td>21600</td>
      <td>36</td>
      <td>0</td>
      <td>2</td>
      <td>30000.0</td>
      <td>2</td>
      <td>0</td>
      <td>10.16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14.07</td>
      <td>23000</td>
      <td>36</td>
      <td>2</td>
      <td>12</td>
      <td>35000.0</td>
      <td>2</td>
      <td>2</td>
      <td>57.96</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>7.35</td>
      <td>24000</td>
      <td>36</td>
      <td>0</td>
      <td>3</td>
      <td>108000.0</td>
      <td>2</td>
      <td>1</td>
      <td>22.28</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>19.03</td>
      <td>10000</td>
      <td>36</td>
      <td>3</td>
      <td>17</td>
      <td>121000.0</td>
      <td>0</td>
      <td>2</td>
      <td>32.38</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>23.88</td>
      <td>30000</td>
      <td>36</td>
      <td>4</td>
      <td>21</td>
      <td>67000.0</td>
      <td>0</td>
      <td>2</td>
      <td>45.26</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>5.32</td>
      <td>24000</td>
      <td>36</td>
      <td>0</td>
      <td>0</td>
      <td>80000.0</td>
      <td>0</td>
      <td>1</td>
      <td>11.99</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>10.91</td>
      <td>12800</td>
      <td>36</td>
      <td>1</td>
      <td>8</td>
      <td>66000.0</td>
      <td>2</td>
      <td>0</td>
      <td>20.82</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 9 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-9393a3d1-d9cb-4f51-92ec-16a83684c4ef')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-9393a3d1-d9cb-4f51-92ec-16a83684c4ef button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-9393a3d1-d9cb-4f51-92ec-16a83684c4ef');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:608,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="f64c55d0" data-outputId="dee995c1-d7cc-4b2a-8efe-f6eb9524af28">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>top <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>corr <span class="op">=</span> df2.corr()</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>top15 <span class="op">=</span> corr.nlargest(top, <span class="st">&#39;sub_grade&#39;</span>)[<span class="st">&#39;sub_grade&#39;</span>].index</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>corr_top15 <span class="op">=</span> df2[top15].corr()</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>sns.heatmap(corr_top15, square<span class="op">=</span><span class="va">True</span>, ax<span class="op">=</span>ax, annot<span class="op">=</span><span class="va">True</span>, cmap<span class="op">=</span><span class="st">&#39;coolwarm&#39;</span>, fmt<span class="op">=</span><span class="st">&#39;.2f&#39;</span>, annot_kws<span class="op">=</span>{<span class="st">&#39;size&#39;</span>:<span class="dv">12</span>})</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Top correlated features of dataset&#39;</span>, size<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/7e690dfe509692d3aef9bdacc3e6e375dd6bf8a5.png" /></p>
</div>
</div>
<div class="cell markdown" id="b3727ac3">
<p><strong>There are 2 variables grade and sub_grade have corrolation for variable interest_rate is large compared to other variables</strong></p>
</div>
<div class="cell markdown" id="864f95f1">
<p>Kiểm tra mối tương quan giữa interest_rate và grade</p>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:377,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="&quot;19539458&quot;" data-outputId="6f2cce15-7e22-4e5e-ddb9-6728c232bac6">
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x<span class="op">=</span>df2[<span class="st">&#39;grade&#39;</span>], y<span class="op">=</span>df2[<span class="st">&#39;sub_grade&#39;</span>], data<span class="op">=</span>df2)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>ax.set_xticks((<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>))</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels((<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;F&#39;</span>,<span class="st">&#39;G&#39;</span>))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># bỏ đường kẻ ở trên và bên phải chart</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>spines <span class="op">=</span> [<span class="st">&#39;top&#39;</span>, <span class="st">&#39;right&#39;</span>]</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> spines:</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    ax.spines[s].set_visible(<span class="va">False</span>) </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># bỏ dấu tích ở 2 trục</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>ax.tick_params(left<span class="op">=</span><span class="va">False</span>, bottom<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;The relationship between interest_rate and grade&#39;</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, size<span class="op">=</span><span class="dv">12</span>, horizontalalignment<span class="op">=</span><span class="st">&#39;left&#39;</span>, x<span class="op">=</span><span class="fl">0.125</span>, y <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/bd2efd9dea6c7c6af04c876996866d9fb70ff69c.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="4b7b543f" data-outputId="d9d3d538-cb64-4f75-9070-a394742a7915">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df2[<span class="st">&#39;grade&#39;</span>], df2[<span class="st">&#39;sub_grade&#39;</span>])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Correlation Coefficient between grade and interest_rate is&quot;</span>, pearson_coef, <span class="st">&quot;and P-value is &quot;</span>, p_value)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Correlation Coefficient between grade and interest_rate is 0.9702897687820276 and P-value is  0.0
</code></pre>
</div>
</div>
<div class="cell markdown" id="1186ee24">
<p>Check Correlation between interest_rate and grade</p>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:377,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="c24251e5" data-outputId="fed4f7ae-0fd1-4f54-b87f-7dfa76aa0bb3">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.regplot(x<span class="op">=</span>df2[<span class="st">&#39;interest_rate&#39;</span>], y<span class="op">=</span>df2[<span class="st">&#39;sub_grade&#39;</span>], data<span class="op">=</span>df2)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co"># bỏ đường kẻ ở trên và bên phải chart</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>spines <span class="op">=</span> [<span class="st">&#39;top&#39;</span>, <span class="st">&#39;right&#39;</span>]</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> s <span class="kw">in</span> spines:</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    ax.spines[s].set_visible(<span class="va">False</span>) </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co"># bỏ dấu tích ở 2 trục</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>ax.tick_params(left<span class="op">=</span><span class="va">False</span>, bottom<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;The relationship between interest_rate and sub_grade&#39;</span>, fontweight<span class="op">=</span><span class="st">&#39;bold&#39;</span>, size<span class="op">=</span><span class="dv">12</span>, horizontalalignment<span class="op">=</span><span class="st">&#39;left&#39;</span>, x<span class="op">=</span><span class="fl">0.125</span>, y <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_64f69637a4084af3abb01df6a5d1ce09/4da3fd25981e2879c8b4136d2e8b182a7135ffca.png" /></p>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="f12f5f36" data-outputId="567bfc68-2d01-452e-d103-6370656cc085">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df2[<span class="st">&#39;interest_rate&#39;</span>], df2[<span class="st">&#39;sub_grade&#39;</span>])</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Correlation Coefficient between sub_grade and interest_rate là&quot;</span>, pearson_coef, <span class="st">&quot;and P-value is &quot;</span>, p_value)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Correlation Coefficient between sub_grade and interest_rate là 0.9929205599072595 and P-value is  0.0
</code></pre>
</div>
</div>
<section id="building-model" class="cell markdown" id="e9637368">
<h1>Building model</h1>
</section>
<section id="scaling-and-test-train-split" class="cell markdown" id="27596e0b">
<h2>Scaling and Test Train split</h2>
</section>
<div class="cell code" id="0aa1733e">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span></code></pre></div>
</div>
<div class="cell code" id="fc216ef6">
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df2[[<span class="st">&#39;grade&#39;</span>,<span class="st">&#39;interest_rate&#39;</span>]]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df2[<span class="st">&#39;sub_grade&#39;</span>]</span></code></pre></div>
</div>
<div class="cell code" id="d0d7fd55">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size<span class="op">=</span><span class="fl">0.15</span>)</span></code></pre></div>
</div>
<section id="scaling" class="cell markdown" id="81fc2c0e">
<h2>Scaling</h2>
</section>
<div class="cell code" id="0245be09">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span></code></pre></div>
</div>
<div class="cell code" id="d7f66887">
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> MinMaxScaler()</span></code></pre></div>
</div>
<div class="cell code" id="ab03018f">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> scaler.fit_transform(X_train)</span></code></pre></div>
</div>
<div class="cell code" id="64a38598">
<div class="sourceCode" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> scaler.transform(X_test)</span></code></pre></div>
</div>
<section id="xgboost-model" class="cell markdown" id="9b8d605c">
<h3>XGBoost model</h3>
</section>
<section id="random-forests-model" class="cell markdown" id="e7c61152">
<h3>Random Forests model</h3>
</section>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="WYTRuhenEZMU" data-outputId="5c6d43a0-40aa-4b8d-9c21-8ebc87c753c1">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install Jinja2</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: Jinja2 in /usr/local/lib/python3.7/dist-packages (2.11.3)
Requirement already satisfied: MarkupSafe&gt;=0.23 in /usr/local/lib/python3.7/dist-packages (from Jinja2) (2.0.1)
</code></pre>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="BVhNTULXplek" data-outputId="fcbf906a-3c43-436c-f7b2-013ef781da18">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>pip install cartopy</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: cartopy in /usr/local/lib/python3.7/dist-packages (0.19.0.post1)
Requirement already satisfied: pyshp&gt;=2 in /usr/local/lib/python3.7/dist-packages (from cartopy) (2.3.0)
Requirement already satisfied: numpy&gt;=1.13.3 in /usr/local/lib/python3.7/dist-packages (from cartopy) (1.19.5)
Requirement already satisfied: shapely&gt;=1.5.6 in /usr/local/lib/python3.7/dist-packages (from cartopy) (1.8.1.post1)
</code></pre>
</div>
</div>
<div class="cell code" data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="NgGeV7QtqBew" data-outputId="034dae4c-7c1f-4bfd-d8bc-150a6ab68fcd">
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pip install markupsafe<span class="op">==</span><span class="fl">2.0.1</span></span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: markupsafe==2.0.1 in /usr/local/lib/python3.7/dist-packages (2.0.1)
</code></pre>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:1000,&quot;referenced_widgets&quot;:[&quot;76006eda34524006aa054d2bff63bcda&quot;,&quot;ee3200aa3ff748f798d91c13d7201f8f&quot;,&quot;2c0a5857a0244dc5beb88e418397599a&quot;,&quot;6069854a4b5c4b518461645a53e7a3b6&quot;,&quot;6fd28da5d03a44d4a1bab880a99437f8&quot;,&quot;3b9fa796659c470c885d647d56c9d1a5&quot;],&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="tGHOWygi5-vq" data-outputId="bfade3c6-b8e6-40b2-bf91-f307b8d7f3eb">
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pycaret.classification <span class="im">import</span> <span class="op">*</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>classification <span class="op">=</span> setup(data <span class="op">=</span> df2, target <span class="op">=</span> <span class="st">&#39;sub_grade&#39;</span>, use_gpu<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output display_data">

  <div id="df-fa47615a-71b1-43e4-b370-5bc86ebb28f0">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>session_id</td>
      <td>2604</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Target</td>
      <td>sub_grade</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Target Type</td>
      <td>Multiclass</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Label Encoded</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Original Data</td>
      <td>(10000, 9)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Missing Values</td>
      <td>False</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Numeric Features</td>
      <td>4</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Categorical Features</td>
      <td>4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Ordinal Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>9</th>
      <td>High Cardinality Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>10</th>
      <td>High Cardinality Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Transformed Train Set</td>
      <td>(6999, 18)</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Transformed Test Set</td>
      <td>(3001, 18)</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Shuffle Train-Test</td>
      <td>True</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Stratify Train-Test</td>
      <td>False</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Fold Generator</td>
      <td>StratifiedKFold</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Fold Number</td>
      <td>10</td>
    </tr>
    <tr>
      <th>17</th>
      <td>CPU Jobs</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Use GPU</td>
      <td>True</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Log Experiment</td>
      <td>False</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Experiment Name</td>
      <td>clf-default-name</td>
    </tr>
    <tr>
      <th>21</th>
      <td>USI</td>
      <td>37ce</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Imputation Type</td>
      <td>simple</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Iterative Imputation Iteration</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Numeric Imputer</td>
      <td>mean</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Iterative Imputation Numeric Model</td>
      <td>None</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Categorical Imputer</td>
      <td>constant</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Iterative Imputation Categorical Model</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Unknown Categoricals Handling</td>
      <td>least_frequent</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Normalize</td>
      <td>False</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Normalize Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Transformation</td>
      <td>False</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Transformation Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>33</th>
      <td>PCA</td>
      <td>False</td>
    </tr>
    <tr>
      <th>34</th>
      <td>PCA Method</td>
      <td>None</td>
    </tr>
    <tr>
      <th>35</th>
      <td>PCA Components</td>
      <td>None</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Ignore Low Variance</td>
      <td>False</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Combine Rare Levels</td>
      <td>False</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Rare Level Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Numeric Binning</td>
      <td>False</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Remove Outliers</td>
      <td>False</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Outliers Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Remove Multicollinearity</td>
      <td>False</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Multicollinearity Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Remove Perfect Collinearity</td>
      <td>True</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Clustering</td>
      <td>False</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Clustering Iteration</td>
      <td>None</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Polynomial Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Polynomial Degree</td>
      <td>None</td>
    </tr>
    <tr>
      <th>49</th>
      <td>Trignometry Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>50</th>
      <td>Polynomial Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Group Features</td>
      <td>False</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Feature Selection</td>
      <td>False</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Feature Selection Method</td>
      <td>classic</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Features Selection Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>55</th>
      <td>Feature Interaction</td>
      <td>False</td>
    </tr>
    <tr>
      <th>56</th>
      <td>Feature Ratio</td>
      <td>False</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Interaction Threshold</td>
      <td>None</td>
    </tr>
    <tr>
      <th>58</th>
      <td>Fix Imbalance</td>
      <td>False</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Fix Imbalance Method</td>
      <td>SMOTE</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fa47615a-71b1-43e4-b370-5bc86ebb28f0')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fa47615a-71b1-43e4-b370-5bc86ebb28f0 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fa47615a-71b1-43e4-b370-5bc86ebb28f0');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:36,&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="xPiSdPuh5X5p" data-outputId="7fa0cefb-5141-463e-fca0-b332359b182d">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.utils.multiclass <span class="im">import</span> type_of_target</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>type_of_target(y)</span></code></pre></div>
<div class="output execute_result" data-execution_count="38">
<div class="sourceCode" id="cb46"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="st">&quot;string&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:237,&quot;referenced_widgets&quot;:[&quot;fea32f198dcc4cbea0dd21d2fc7cf11c&quot;,&quot;e25defcb366346d3ab1421ae1232f3e6&quot;,&quot;6e90b4317f694a57858dda4d299ea7c8&quot;],&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="34d9b96f" data-outputId="b916a5d0-1606-4767-c379-58401e644294">
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>xgb <span class="op">=</span> create_model(<span class="st">&#39;xgboost&#39;</span>, fold<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div>
<div class="output display_data">

  <div id="df-f6ab4d68-7ec2-426a-be3d-481785eef2d4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
    </tr>
    <tr>
      <th>Fold</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.0000</td>
      <td>0.0</td>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>1.0000</td>
      <td>1.0000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.9996</td>
      <td>0.0</td>
      <td>0.9996</td>
      <td>0.9996</td>
      <td>0.9996</td>
      <td>0.9995</td>
      <td>0.9995</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.9983</td>
      <td>0.0</td>
      <td>0.9213</td>
      <td>0.9978</td>
      <td>0.9980</td>
      <td>0.9982</td>
      <td>0.9982</td>
    </tr>
    <tr>
      <th>Mean</th>
      <td>0.9993</td>
      <td>0.0</td>
      <td>0.9736</td>
      <td>0.9991</td>
      <td>0.9992</td>
      <td>0.9992</td>
      <td>0.9992</td>
    </tr>
    <tr>
      <th>Std</th>
      <td>0.0007</td>
      <td>0.0</td>
      <td>0.0370</td>
      <td>0.0010</td>
      <td>0.0009</td>
      <td>0.0008</td>
      <td>0.0008</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-f6ab4d68-7ec2-426a-be3d-481785eef2d4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-f6ab4d68-7ec2-426a-be3d-481785eef2d4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-f6ab4d68-7ec2-426a-be3d-481785eef2d4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell code" data-colab="{&quot;height&quot;:424,&quot;referenced_widgets&quot;:[&quot;0a7df42a35de4d6199808b2ca4b6e5a4&quot;,&quot;833911cbd6e342af8b68ea8e07f00f9e&quot;,&quot;70f6811d65834a59bc99ccd89d5044a8&quot;],&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}" id="c25ClhIh_TOp" data-outputId="e86527a4-fe39-4893-ca3b-4f71e1ff3dda">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>best <span class="op">=</span> compare_models()</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb49"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;0a7df42a35de4d6199808b2ca4b6e5a4&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output display_data">

  <div id="df-10fe91ed-8058-488f-838e-e268244b7fb7">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Initiated</th>
      <td>. . . . . . . . . . . . . . . . . .</td>
      <td>19:14:04</td>
    </tr>
    <tr>
      <th>Status</th>
      <td>. . . . . . . . . . . . . . . . . .</td>
      <td>Fitting 10 Folds</td>
    </tr>
    <tr>
      <th>Estimator</th>
      <td>. . . . . . . . . . . . . . . . . .</td>
      <td>Gradient Boosting Classifier</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-10fe91ed-8058-488f-838e-e268244b7fb7')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-10fe91ed-8058-488f-838e-e268244b7fb7 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-10fe91ed-8058-488f-838e-e268244b7fb7');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
<div class="output display_data">

  <div id="df-ea42a5ae-2c35-4bab-a817-466a6ba06cd1">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Model</th>
      <th>Accuracy</th>
      <th>AUC</th>
      <th>Recall</th>
      <th>Prec.</th>
      <th>F1</th>
      <th>Kappa</th>
      <th>MCC</th>
      <th>TT (Sec)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>dt</th>
      <td>Decision Tree Classifier</td>
      <td>0.9994</td>
      <td>0.0</td>
      <td>0.9897</td>
      <td>0.9994</td>
      <td>0.9994</td>
      <td>0.9994</td>
      <td>0.9994</td>
      <td>0.026</td>
    </tr>
    <tr>
      <th>rf</th>
      <td>Random Forest Classifier</td>
      <td>0.9930</td>
      <td>0.0</td>
      <td>0.9271</td>
      <td>0.9933</td>
      <td>0.9927</td>
      <td>0.9926</td>
      <td>0.9926</td>
      <td>2.170</td>
    </tr>
    <tr>
      <th>ridge</th>
      <td>Ridge Classifier</td>
      <td>0.4568</td>
      <td>0.0</td>
      <td>0.4155</td>
      <td>0.3674</td>
      <td>0.3351</td>
      <td>0.4273</td>
      <td>0.4387</td>
      <td>0.039</td>
    </tr>
    <tr>
      <th>nb</th>
      <td>Naive Bayes</td>
      <td>0.3992</td>
      <td>0.0</td>
      <td>0.3691</td>
      <td>0.3884</td>
      <td>0.3482</td>
      <td>0.3669</td>
      <td>0.3721</td>
      <td>0.020</td>
    </tr>
    <tr>
      <th>ada</th>
      <td>Ada Boost Classifier</td>
      <td>0.2257</td>
      <td>0.0</td>
      <td>0.1930</td>
      <td>0.0794</td>
      <td>0.1041</td>
      <td>0.1789</td>
      <td>0.2087</td>
      <td>0.663</td>
    </tr>
    <tr>
      <th>knn</th>
      <td>K Neighbors Classifier</td>
      <td>0.0633</td>
      <td>0.0</td>
      <td>0.0475</td>
      <td>0.0655</td>
      <td>0.0552</td>
      <td>0.0114</td>
      <td>0.0115</td>
      <td>0.201</td>
    </tr>
    <tr>
      <th>svm</th>
      <td>SVM - Linear Kernel</td>
      <td>0.0387</td>
      <td>0.0</td>
      <td>0.0285</td>
      <td>0.0046</td>
      <td>0.0064</td>
      <td>-0.0014</td>
      <td>-0.0041</td>
      <td>0.613</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-ea42a5ae-2c35-4bab-a817-466a6ba06cd1')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">
        
  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>
      
  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-ea42a5ae-2c35-4bab-a817-466a6ba06cd1 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-ea42a5ae-2c35-4bab-a817-466a6ba06cd1');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>
  
</div>
</div>
<div class="cell markdown" id="pv3PME5h6hpS">
<p>=&gt; From the above it can be seen that the "Decision Tree Classifier" model gives the highest ratio</p>
</div>
<div class="cell code" id="TqgJoIE66whF">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"></code></pre></div>
</div>
</body>
</html>
